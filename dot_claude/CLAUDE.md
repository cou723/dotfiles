- 仕様自然言語
  - 基本的に日本語で回答せよ
  - 詳細
    - 会話: 日本語
    - 思考: 日本語
    - コメントアウト: 明示されていない場合は日本語、プロジェクトで英語が使われたいた場合は英語
    - コミットメッセージ: 明示されていない場合は日本語、プロジェクトで英語が使われたいた場合は英語
- 要求、要件定義時
  - ユーザーはあなたに「情報を大量のソースから高速に検証し、クオリティの高い出力」を期待している
    - 速く回答することや納得感のある回答を求めているわけではない
    - 暗記で早く答えるということは非推奨
  - 速さより**正確性を重視**。不明点は推測せず質問か調査。
    - 最善の回答のために不明確な点や不明瞭な点があった場合、**推測せず**必ずユーザーに聞くかインターネットで調査せよ
    - あなたは常に数多くの前提に立って結論を出している。その前提を一つ一つ列挙し、それぞれが正しいかどうか、ソースを併記したりその他調査系のmcpやツールを使用しなさい
- 修正内容が統合テストなどでしか確認できない場合でも最低限型チェックは通した状態で作業を終え、できない場合は必ず理由を明示してください。
- コーディング
  - 型安全性
    - 型安全なコードを意識しなさい
    - 型推論を活用しなさい
  - テスト
    - テストは最低限のテストを書きなさい。冗長なコードは理解に時間を要します
      - テストの保守もリソースが必要です。変更点が多くなると予想される個所や作りかけの箇所にはテストを書かないという選択肢もありますが、テストを書くよう明示された場合は必ず書きなさい
    - テストは以下の目的で書かれる
      - 既存の機能が壊れていないか
      - 現在の機能が想定通りに実装されているか
  - 例外
    - throwの使用は原則禁止(moonbitを除く)
      - 返り値を用いて失敗を表現すること
  - TypeScript
    - 推奨ツール(明示されない限り以下のものを使用)
      - linter: biome.js
      - formatter: biome.js
      - package manager: pnpm
      - testing framework: vitest
    - 標準のDateの「メソッド」（データの構造体として使う分には問題ない）はタイムゾーン準拠で挙動が変わるため、非推奨です。date-fnsなどを使用せよ
    - `as any`は原則禁止です。`as unknown as T`も基本的には非推奨です。
      - ただし、`as unknown as T`はコメントでそれを使わないといけない理由を明示した限り使用してよいです。
    - 例外表現
      - catchは型安全でないため非推奨。どうしても使う場合は型安全に書く
      - Effect.tsが使われているプロジェクトの場合、Effect.tsの流儀に沿った形で書く
  - Python
    - 推奨ツール
      - Package・Runtime Manager：UV
      - Linter：Ruff
      - TypeChecker：Mypy
    - 非推奨事項
      - **グローバルにあるpip**を使ったパッケージの追加
        - `uv add`を推奨
    - 実行する際は必ず仮想環境のPythonを使用してください。ex:`uv run main.py` or `source .venv/activate && uv run main.py`
- ドキュメント
  - ドキュメントについて機能の追加や変更をした際にはドキュメントが古い内容になっていないか**毎回**確認しなさい
  - ドキュメントに該当するファイルは以下の通り
    - `docs/**/*.md`
    - `CLAUDE.md`
    - `AGENTS.md`
    - `GEMINI.md`
  - ドキュメントは簡潔にかつ抽象的に
    - 具体例をあまり細かく書いてしまうと、すぐにコードベースから乖離、メンテナンスコストが増加し、メリット以上にデメリットが大きく
    - 具体例を書く場合も抽象的概念を先に書いてから例示として書け
  - Asciiアートを使った図は書いてはいけない
    - 全角文字の都合上、日本語が混ざる場合、Ascii アートは非推奨
    - どうしても書いたほうがわかりやすい場合は英語でのみ許可します
    - 図を書きたい場合はMermaid図などのマークアップ言語を用いて書きなさい